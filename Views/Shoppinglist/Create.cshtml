@model ShoppinglistApp.Models.Shoppinglist

@{
	ViewData["Title"] = "Create";
}

<h1>Create</h1>

<h4>Shoppinglist</h4>
<hr />
<div class="row">
	<div class="col-md-4">
		@*<form>*@
		<div class="text-danger"></div>

		<div class="form-group">
			<label>Name for the list</label>
			<input id="listName" />
			@*<span asp-validation-for="ListName" class="text-danger"></span>*@
			<span class="control-label">Add item to list</span> <br />
			<input id="addMe" class="form-control" />  <br />
			<input type="button" id="addSLI" onclick="addFunction()" value="Add to list" class="btn btn-primary" />
		</div>
		<div class="form-group">
			<input type="button" value="Create" onclick="submitForm()" class="btn btn-primary" />
		</div>
		@*</form>*@
	</div>
	<div class="col-md-4">
		<h5>Items on your shoppinglist</h5> <br />
		<div id="addedItems">
		</div>
	</div>
</div>

<div>
	<a asp-action="Index">Back to List</a>
</div>

@section Scripts {
	@{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>


<script type="text/javascript" language="javascript">
	var itemArr = [];
	function addFunction() {
		var item = document.getElementById("addMe").value;
		itemArr.push(item);
		$("#addedItems").append(item + "<br>");
	}


	function submitForm() {
		var model = new Object();
		model.listName = document.getElementById("listName").value;
		model.items = itemArr;
		
		$.ajax({
			type: "POST",
			url: '/Shoppinglist/Create',
			data: { array:JSON.stringify(model) },
			success: function (data) {
				alert(data);
			},
			failure: function (errMsg) {
				alert(errMsg);
			}
		});
	}
</script>
